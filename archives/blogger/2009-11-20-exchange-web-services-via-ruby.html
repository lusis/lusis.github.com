--- 
name: exchange-web-services-via-ruby
layout: post
title: Exchange Web Services via Ruby
time: 2009-11-20 22:36:00 -05:00
---
I realized as I went to post an update on this that I don't think I ever posted an actual blog entry about it.<br /><br />While I was on contract at HSWI, the email was hosted on Exchange. The development team was all on Mac workstations but the front-side was all on Windows. Since I was running Linux full-time, Exchange access wasn't a big deal. I ran Mutt and used LDAP/IMAPS/SSMTP. Digging around the Mail.app on the OS X side however, I realized that the client side was using Exchange Web Services for much of the functionality.<br /><br />Wanting to do some poking around with Ruby and SOAP, I figured it would be a fun exercise to talk to the Exchange server with Ruby. I also had an itch to scratch thinking I could use it as an address book source for Mutt. I got it working in a day or so after dealing with some broken functionality in either the WSDL from the Exchange side or how SOAP4R tried to translate it.<br /><br />You can find the code <a href="http://dev.lusis.org/code/ruby-ews/">here.</a><br /><br />Anyway, I'm no longer with HSWI but over at the <a href="http://www.ajc.com">AJC</a>, we're also using Exchange in a much greater capacity. Anyway, so I whipped out the "old" code and was depressed to find out it didn't work.<br /><br />Every attempt gave me a 401 error. It made no sense since I could access OWA, ActiveSync with my DROID (awww yeah) and even access the EWS wsdls on the server.<br /><br />As I started to poke around online, I started to realize that in some of the more complex configurations, the Exchange server is hidden behind an ISA server or something. I don't do the Microsoft world much anymore and I have no real access to the environment.<br /><br />What I noticed though, was that the internal IP is different than the external one. That gave me an idea to make sure and test the code externally from home while NOT being on the VPN.<br /><br />It worked!<br /><br />As I poked around with THAT information, I remembered an interesting thing that happened the one time I logged. on to a Windows machine at the office. If I fired up I.E. and went to the OWA url, I was logged in directly.<br /><br />What I'm guessing is that the Exchange server has a different set of criteria for authenticating internally than externally. I'm not up to date on current Exchange and AD implementations so I have no idea what the configuration is that's preventing me from using EWS but still allowing me to use OWA from Firefox under Linux and OS X.<br /><br />If any MS guys out there have any idea what's causing this, I'd be interested to know so I can either work around it or document it appropriately.<br /><br />I have a *FEELING* that it's somehow related to NTLM but I don't know how to force my EWS call to bypass it just yet.<div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/934985301455705990-3707388144405833350?l=lusislog.blogspot.com' alt='' /></div>
